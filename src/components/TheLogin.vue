<template>
  <svg class="auth-bg" width="1920" height="1080" viewBox="0 0 1920 1080" fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path
      d="M-154.98 1099.38C613.719 529.746 938.105 1076.46 1163.41 334.79C1340.21 -247.23 1533.39 -340.024 1803.74 -333.212"
      stroke="black" />
    <path d="M124.61 1642.62C893.31 1072.99 1217.7 1619.7 1443 878.031C1619.8 296.011 1812.98 203.217 2083.33 210.029"
      stroke="black" />
    <path
      d="M-143.302 1122.07C625.398 552.442 949.784 1099.16 1175.09 357.486C1351.89 -224.534 1545.06 -317.328 1815.42 -310.516"
      stroke="black" />
    <path
      d="M-131.865 1144.3C636.834 574.665 961.22 1121.38 1186.52 379.709C1363.33 -202.311 1556.5 -295.105 1826.85 -288.293"
      stroke="black" />
    <path
      d="M-120.669 1166.05C648.031 596.417 972.417 1143.13 1197.72 401.462C1374.52 -180.559 1567.7 -273.353 1838.05 -266.541"
      stroke="black" />
    <path
      d="M-109.718 1187.33C658.982 617.696 983.368 1164.41 1208.67 422.74C1385.47 -159.28 1578.65 -252.074 1849 -245.262"
      stroke="black" />
    <path
      d="M-99.0077 1208.13C669.692 638.503 994.078 1185.22 1219.38 443.548C1396.18 -138.473 1589.36 -231.266 1859.71 -224.455"
      stroke="black" />
    <path
      d="M-88.5429 1228.47C680.157 658.838 1004.54 1205.55 1229.84 463.883C1406.65 -118.138 1599.82 -210.932 1870.18 -204.12"
      stroke="black" />
    <path
      d="M-78.3222 1248.33C690.377 678.699 1014.76 1225.42 1240.06 483.744C1416.87 -98.2763 1610.04 -191.07 1880.4 -184.258"
      stroke="black" />
    <path
      d="M-68.3417 1267.72C700.358 698.089 1024.74 1244.81 1250.05 503.134C1426.85 -78.8865 1620.02 -171.68 1890.38 -164.869"
      stroke="black" />
    <path
      d="M-58.6054 1286.64C710.094 717.007 1034.48 1263.72 1259.78 522.052C1436.59 -59.968 1629.76 -152.762 1900.11 -145.95"
      stroke="black" />
    <path
      d="M-49.1122 1305.08C719.587 735.452 1043.97 1282.17 1269.27 540.497C1446.08 -41.5231 1639.25 -134.317 1909.61 -127.505"
      stroke="black" />
    <path
      d="M-39.8612 1323.06C728.838 753.425 1053.22 1300.14 1278.53 558.47C1455.33 -23.5501 1648.5 -116.344 1918.86 -109.532"
      stroke="black" />
    <path
      d="M-30.8534 1340.56C737.846 770.926 1062.23 1317.64 1287.53 575.971C1464.34 -6.04939 1657.51 -98.8433 1927.87 -92.0314"
      stroke="black" />
    <path
      d="M-22.0897 1357.59C746.61 787.954 1071 1334.67 1296.3 592.999C1473.1 10.9788 1666.28 -81.8152 1936.63 -75.0033"
      stroke="black" />
    <path
      d="M-13.5702 1374.14C755.129 804.51 1079.52 1351.23 1304.82 609.555C1481.62 27.5342 1674.8 -65.2597 1945.15 -58.4478"
      stroke="black" />
    <path
      d="M-5.28993 1390.22C763.41 820.594 1087.8 1367.31 1313.1 625.639C1489.9 43.6183 1683.08 -49.1756 1953.43 -42.3638"
      stroke="black" />
    <path
      d="M2.74425 1405.84C771.444 836.206 1095.83 1382.92 1321.13 641.25C1497.93 59.2302 1691.11 -33.5638 1961.46 -26.7519"
      stroke="black" />
    <path
      d="M10.5372 1420.98C779.237 851.345 1103.62 1398.06 1328.92 656.39C1505.73 74.3694 1698.9 -18.4245 1969.26 -11.6126"
      stroke="black" />
    <path
      d="M18.0841 1435.64C786.784 866.011 1111.17 1412.73 1336.47 671.056C1513.27 89.036 1706.45 -3.75792 1976.8 3.05395"
      stroke="black" />
    <path
      d="M25.3907 1449.84C794.09 880.206 1118.48 1426.92 1343.78 685.25C1520.58 103.23 1713.76 10.4362 1984.11 17.2481"
      stroke="black" />
    <path
      d="M32.4513 1463.56C801.151 893.928 1125.54 1440.64 1350.84 698.972C1527.64 116.952 1720.82 24.1582 1991.17 30.9701"
      stroke="black" />
    <path
      d="M39.2716 1476.81C807.971 907.178 1132.36 1453.89 1357.66 712.222C1534.46 130.202 1727.64 37.4082 1997.99 44.2201"
      stroke="black" />
    <path
      d="M45.8468 1489.59C814.546 919.955 1138.93 1466.67 1364.23 725C1541.04 142.979 1734.21 50.1855 2004.57 56.9974"
      stroke="black" />
    <path
      d="M52.1808 1501.89C820.88 932.26 1145.27 1478.98 1370.57 737.304C1547.37 155.284 1740.55 62.4902 2010.9 69.3021"
      stroke="black" />
    <path
      d="M58.2706 1513.72C826.97 944.093 1151.36 1490.81 1376.66 749.138C1553.46 167.118 1746.64 74.3236 2016.99 81.1355"
      stroke="black" />
    <path
      d="M64.1183 1525.08C832.818 955.453 1157.2 1502.17 1382.51 760.498C1559.31 178.478 1752.48 85.6839 2022.84 92.4958"
      stroke="black" />
    <path
      d="M69.7218 1535.97C838.421 966.342 1162.81 1513.06 1388.11 771.387C1564.91 189.366 1758.09 96.5723 2028.44 103.384"
      stroke="black" />
    <path
      d="M75.0841 1546.39C843.784 976.758 1168.17 1523.47 1393.47 781.802C1570.27 199.782 1763.45 106.988 2033.8 113.8"
      stroke="black" />
    <path
      d="M80.1993 1556.33C848.899 986.701 1173.28 1533.42 1398.59 791.746C1575.39 209.726 1768.57 116.932 2038.92 123.744"
      stroke="black" />
    <path
      d="M85.0753 1565.8C853.775 996.172 1178.16 1542.89 1403.46 801.217C1580.27 219.197 1773.44 126.403 2043.79 133.215"
      stroke="black" />
    <path
      d="M89.7062 1574.8C858.406 1005.17 1182.79 1551.89 1408.09 810.216C1584.9 228.196 1778.07 135.402 2048.42 142.214"
      stroke="black" />
    <path
      d="M94.0948 1583.33C862.794 1013.7 1187.18 1560.41 1412.48 818.742C1589.29 236.722 1782.46 143.928 2052.81 150.74"
      stroke="black" />
    <path
      d="M98.2403 1591.38C866.94 1021.75 1191.33 1568.47 1416.63 826.797C1593.43 244.777 1786.61 151.983 2056.96 158.795"
      stroke="black" />
    <path
      d="M102.142 1598.96C870.841 1029.33 1195.23 1576.05 1420.53 834.378C1597.33 252.358 1790.51 159.564 2060.86 166.376"
      stroke="black" />
    <path
      d="M105.801 1606.07C874.5 1036.44 1198.89 1583.16 1424.19 841.488C1600.99 259.468 1794.17 166.674 2064.52 173.486"
      stroke="black" />
    <path
      d="M109.218 1612.71C877.917 1043.08 1202.3 1589.8 1427.6 848.126C1604.41 266.106 1797.58 173.312 2067.94 180.124"
      stroke="black" />
    <path
      d="M112.391 1618.88C881.09 1049.25 1205.48 1595.96 1430.78 854.291C1607.58 272.27 1800.76 179.476 2071.11 186.288"
      stroke="black" />
    <path
      d="M115.322 1624.57C884.022 1054.94 1208.41 1601.66 1433.71 859.984C1610.51 277.964 1803.69 185.17 2074.04 191.982"
      stroke="black" />
    <path
      d="M118.006 1629.79C886.706 1060.16 1211.09 1606.88 1436.39 865.203C1613.2 283.183 1806.37 190.389 2076.72 197.201"
      stroke="black" />
    <path
      d="M120.451 1634.54C889.151 1064.91 1213.54 1611.62 1438.84 869.952C1615.64 287.932 1808.82 195.138 2079.17 201.95"
      stroke="black" />
    <path
      d="M122.651 1638.81C891.351 1069.18 1215.74 1615.9 1441.04 874.228C1617.84 292.208 1811.02 199.414 2081.37 206.226"
      stroke="black" />
  </svg>
  <div class="auth">
    <h2 class="auth__logo">DETAILING.GURU</h2>
    <span class="auth__title">Вход</span>
    <div class="auth-info">
      <div>
        <label class="auth__label" for="mail">Почта</label>
        <input v-model="email" class="auth__input" type="email" required placeholder="">
      </div>
      <div>
        <label class="auth__label" for="pass">Пароль</label>
        <input v-model="password" class="auth__input" type="password" required placeholder="">
      </div>
    </div>
    <button class="auth__btn" @click="loginUser">Вход</button>
    <p class="auth__text">У вас ещё нет аккаунта? <a class="auth__link" href="/register">Зарегистрироваться</a></p>
  </div>
</template>

<script>
import { ref } from 'vue';

export default {
  setup() {
    const email = ref('');
    const password = ref('');

    const loginUser = async () => {
      try {
        const response = await fetch('http://localhost:5000/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            email: email.value,
            password: password.value,
          }),
        });

        if (response.ok) {
          const data = await response.json();
          console.log('Данные пользователя:', data);
          localStorage.setItem('user', JSON.stringify(data.user));
          console.log('Редирект на главную страницу');
          window.location.href = '/';
        } else {
          const errorData = await response.json();
          alert(`Ошибка: ${errorData.error}`);
        }
      } catch (error) {
        console.error('Ошибка подключения к серверу:', error);
        alert('Ошибка подключения к серверу.');
      }
    };

    return {
      email,
      password,
      loginUser,
    };
  },
};
</script>

<style>
body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #f0f0f0;
}

.auth-bg {
    position: absolute;
    z-index: -1;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.auth {
    border-radius: 10px;
    background: #FFFFFF;
    box-shadow: 4px 3px 45px 0px rgba(0, 0, 0, 0.25);
    padding: 45px 60px;
    max-width: 570px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.auth__logo {
    margin-bottom: 50px;
    font-family: BOWLER;
    font-size: 36px;
    text-align: center;
}

.auth-info {
    display: flex;
    flex-direction: column;
    gap: 25px;
}

.auth__title {
    font-size: 26px;
    margin-bottom: 26px;
    text-align: center;
    font-weight: 600;
}

.auth__label {
    margin-bottom: 2px;
    display: block;
    font-size: 16px;
    color: #A8A8A8;
}

.auth__input {
    border-radius: 10px;
    background: rgba(236, 236, 236, 0.7);
    width: 100%;
    outline: none;
    border: none;
    padding: 15px;
    color: #454545;
    font-size: 16px;
}

.auth__btn {
    margin: 90px 0 15px;
    border-radius: 10px;
    background: #10141A;
    font-size: 18px;
    color: #fff;
    width: 100%;
    padding: 12px;
    transition: background .4s ease-in-out;
}

.auth__btn:hover {
    background: #454545;
}

.auth__text {
    font-size: 18px;
}

.auth__text a {
    color: #3C99EA;
    transition: color .4s ease-in-out;
}

.auth__text a:hover {
    color: #0057a3;
}
</style>